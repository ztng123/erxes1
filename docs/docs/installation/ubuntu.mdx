---
id: ubuntu
title: Ubuntu 18.04
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## Server Installation Requirements

erxes gives you many options for installing the erxes platform. Below you will find two guides. The first guide is the **Quick Start** guide where we provide a script that automates most of the installation process. The second guide is a comprehensive, **Step by Step** guide where advanced developers can see exactly what is being installed and how.

:::info Ubuntu 18.04
These instructions are for installing erxes on **Ubuntu 18.04**. They should work on any hosting provider that allows you to install Ubuntu 18.04.
:::

### Minimum required server resources

Each hosting company has slightly different server configurations and set-ups. Hosting companies such as [Linode.com](https://www.linode.com/), [Digital Ocean](https://digitalocean.com) and [AWS EC2](https://aws.amazon.com/ec2) offer many different server specifications and configuration options.

To properly install and maintain your erxes installation, the minimum requirements are:

- Ubuntu 18.04 (or other supported Linus distribution)
- 4 cpus
- 8GB RAM
- ability to to SSH as **root user**

:::tip Use one-click installs
You can also use the [Digital Ocean Marketplace](https://marketplace.digitalocean.com/apps/erxes) and [AWS Marketplace](https://aws.amazon.com/marketplace/pp/B086MZ9FVS?qid=1594055516154&sr=0-1&ref_=srh_res_product_title) for an even easier set-up experience.
:::

### Setting up a server with Ubuntu 18.04

- You must have an account with your hosting provider prior to doing these steps.
- You need to create a server with **Ubuntu 18.04** installed, a minimum of **4cpus** and **8GB RAM**. At this time, erxes needs a minimum of 4 cpus and 8GB RAM to finish installation.

### Configure your DNS Records to point at your server

- Your server will have an ip address. You will need to point your `A records` under the _DNS Editor_ for the domain which will host your erxes installation. The propagation is often reported to take up to 24 hours. Most of the time, propagation of your domain name happens within the hour.

:::note Example with a domain called, example.com

If your domain name is **example.com**, and the **ip address** assigned to your server is **44.123.32.12**, then you will have two `A records` that look like this:

| Type | Name            | Value                  |
| ---- | --------------- | ---------------------- |
| A    | www.example.com | points to 44.123.32.12 |

:::

:::note Example with a subdomain called, erxes.example.com

If your domain name is **erxes.example.com**, and the **ip address** assigned to your server is **44.123.32.12**, then you will have two `A records` that look like this:

| Type | Name              | Value                  |
| ---- | ----------------- | ---------------------- |
| A    | erxes.example.com | points to 44.123.32.12 |

**Note:** You do not need to create a subdomain named "erxes.example.com", you can use another name of your choice such as "admin.example.com".
:::

<Tabs
  defaultValue='step-by-step'
  values={[
    { label: 'Quickstart', value: 'quickstart' },
    { label: 'Step by Step', value: 'step-by-step' },
]}>

<TabItem value='quickstart'>

## Installing erxes on Ubuntu 18.04

You can simply follow [Debian doc](/installation/debian10) to install manually.

</TabItem>
<TabItem value='step-by-step'>

## Log into server as root and create erxes user

- Open the terminal or command prompt on your computer. (You will need your **IP address**. In the above example, **44.123.32.12**).

```bash
ssh root@your-ip-address

    The authenticity of host '44.123.32.12 (44.123.32.12)' can't be established.
    ECDSA key fingerprint is SHA256:RbrZOxtr/emNySeNd8rh2C9VPGY76JbSs1Dhpvfkfrk.
    Are you sure you want to continue connecting (yes/no/[fingerprint])?

Yes

    Warning: Permanently added '44.123.32.12' (ECDSA) to the list of known hosts.
    Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64)
```

- Add a user called, "erxes" and grant that user administrative access rights

You don't want to use the **root** user to administer your server. So everything will be done by a user called, **erxes**. To accomplish this run the following commands. They will add a user called **erxes**, give it a password and assign administrative access rights.

```bash
adduser erxes

    Adding user `erxes' ...
    Adding new group `erxes' (1000) ...
    Adding new user `erxes' (1000) with group `erxes' ...
    Creating home directory `/home/erxes' ...
    Copying files from `/etc/skel' ...

Enter new UNIX password: erxes123
Retype new UNIX password: erxes123

    passwd: password updated successfully
    Changing the user information for erxes
    Enter the new value, or press ENTER for the default

    	Full Name []:
        Room Number []:
        Work Phone []:
        Home Phone []:
        Other []:

Is the information correct? [Y/n] y

usermod -aG sudo erxes
```

## Set-up a basic firewall for SSH, nginx 80 and port 443

- Allow OpenSSH, enable it and check the status. OpenSSH will use **port 22**.

```bash

ufw allow OpenSSH

    Rules updated
    Rules updated (v6)

ufw enable
Command may disrupt existing ssh connections. Proceed with operation (y|n)? y

    Firewall is active and enabled on system startup


ufw status

    Status: active

    To                         Action      From
    --                         ------      ----
    OpenSSH                    ALLOW       Anywhere
    OpenSSH (v6)               ALLOW       Anywhere (v6)

```

Your output should like something like the above.

-- Open port 80 (for NGINX) and open port 443. Port 80 allows **http** traffic and port 443 allows **https** traffic.

```bash

ufw allow proto tcp from any to any port 80,443

    Rule added
    Rule added (v6)

Command may disrupt existing ssh connections. Proceed with operation (y|n)? y

    Firewall is active and enabled on system startup

ufw status

    Status: active

    To                         Action      From
    --                         ------      ----
    OpenSSH                    ALLOW       Anywhere
    80,443/tcp                 ALLOW       Anywhere
    OpenSSH (v6)               ALLOW       Anywhere (v6)
    80,443/tcp (v6)            ALLOW       Anywhere (v6)

```

- Exit from server, so that you can log back in as **erxes**

```bash
exit

    logout
    Connection to 44.123.32.12 closed.
```

- Log back into the server as the **erxes** user and provide the password

```bash
ssh erxes@44.123.32.12
erxes@45.79.248.46's password:

    Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64)
```

In the following section, you will install software dependencies that are needed to run erxes. You will also need to install various tools that will help to administer your server or install the packages themselves.

## Nvm install

**Node Version Manage (nvm)** is a tool that allows you to download and install [Node.js](https://nodejs.org/). You can read more about the installation process here: [How to install NVM](https://gist.github.com/d2s/372b5943bce17b964a79)

- Install **nvm** and initialize by reload the shell configuration.

```bash
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash
source ~/.bashrc
```

- Verify **nvm** is installed by running:

```bash
command -v nvm

    nvm
```

If you got the above output, then you are ready to continue with the following steps.

## NodeJS install

```
nvm install v12.16.3
node -v (to check if installed)

```

## NvmPm2 install

```
npm install pm2 -g
```

## Yarn install

```
curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
sudo apt update && sudo apt install --no-install-recommends yarn

```

## MongoDB 3.6 replicaSet install

```
wget -qO - https://www.mongodb.org/static/pgp/server-3.6.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.6 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.6.list
sudo apt-get update
sudo apt-get install -y mongodb-org
sudo systemctl start mongod
sudo systemctl enable mongod
```

### Convert mongodb to replicaset

```
sudo systemctl stop mongod
```

### open mongodb config file:

```
sudo vim /etc/mongod.conf
```

### Enable replicaset settings.

```
replication:
  replSetName: rs0
```

### verify

```
sudo cat /etc/mongod.conf
```

### start mongodb back

```
sudo systemctl start mongod
```

### connect to mongo shell

```
mongo
```

### Initialize replicaset

```
rs.initiate()
```

- after few seconds press enter to verify SECONDARY changes to PRIMARY
- press `ctrl-c` to quit mongo

## Redis

```
sudo apt-get install -y redis
```

## RabbitMQ

(https://www.rabbitmq.com/install-debian.html#apt-packagecloud)

### Erlang 22.x

```
curl -fsSL https://github.com/rabbitmq/signing-keys/releases/download/2.0/rabbitmq-release-signing-key.asc | sudo apt-key add -
sudo apt-get install apt-transport-https
```

- write following lines to this file. (This step needs to be automated, lot of users doesn't know how to exit vim)

```
sudo vim /etc/apt/sources.list.d/bintray.erlang.list
```

- PUT THIS IN THE FILE

```txt
# This repository provides Erlang packages produced by the RabbitMQ team
# See below for supported distribution and component values
deb https://dl.bintray.com/rabbitmq-erlang/debian bionic erlang-22.x
```

- verify

```
sudo cat /etc/apt/sources.list.d/bintray.erlang.list
```

- This is recommended. Metapackages such as erlang and erlang-nox must only be used with apt version pinning. They do not pin their dependency versions.

```
sudo apt-get install -y erlang-base \
 erlang-asn1 erlang-crypto erlang-eldap erlang-ftp erlang-inets \
 erlang-mnesia erlang-os-mon erlang-parsetools erlang-public-key \
 erlang-runtime-tools erlang-snmp erlang-ssl \
 erlang-syntax-tools erlang-tftp erlang-tools erlang-xmerl
```

## Adding key

```
wget -O - "https://packagecloud.io/rabbitmq/rabbitmq-server/gpgkey" | sudo apt-key add -
```

## Adding packagecloud repo

```
curl -s https://packagecloud.io/install/repositories/rabbitmq/rabbitmq-server/script.deb.sh | sudo bash
```

## Ready to install rabbitmq-server, but need erlang dependency

```
sudo apt-get install -y rabbitmq-server
```

## EleasticSearch

```
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
echo "deb https://artifacts.elastic.co/packages/7.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list
sudo apt-get update && sudo apt-get install elasticsearch
sudo /bin/systemctl daemon-reload
sudo /bin/systemctl enable elasticsearch.service
sudo systemctl start elasticsearch.service
sudo systemctl stop elasticsearch.service
```

## Nginx

(https://launchpad.net/~nginx/+archive/ubuntu/stable)
(Nginx from stable repo https://launchpad.net/~nginx/+archive/ubuntu/stable)

```
sudo add-apt-repository ppa:nginx/stable
sudo apt-get update
sudo apt-get install -y nginx
# It started by default when we install it. Just making sure of things.
sudo systemctl enable nginx
sudo systemctl start nginx
```

## Install GitHub

```
sudo apt update
sudo apt install git
git --version
```

## Install erxes

```
cd ~
mkdir erxes
cd erxes
git clone https://github.com/erxes/erxes.git
git clone https://github.com/erxes/erxes-api.git
git clone https://github.com/erxes/erxes-integrations.git
```

- The following assumes the following URLS. You need to use your own url.

```
localhost:3000 => erxes.acneskindisorder.com
localhost:3200 => erxes.acneskindisorder.com/widgets
localhost: 3300 => erxes.acneskindisorder.com/api
localhost: 3400 => erxes.acneskindisorder.com/integrations
```

### Configure erxes UI

```
cd ~/erxes/erxes/ui
yarn install
cp .env.sample .env
```

- open .env file

```bash
vim .env
```

```
PORT=3000
NODE_ENV=development
REACT_APP_CDN_HOST=http://erxes.acneskindisorder.com/widgets
REACT_APP_API_URL=http://erxes.acneskindisorder.com/api
REACT_APP_API_SUBSCRIPTION_URL=ws://erxes.acneskindisorder.com/api/subscriptions
```

### Configure erxes widgets

```bash
cd ~/erxes/erxes/widgets
yarn install
cp .env.sample .env
vim .env
```

```
PORT=3200
ROOT_URL=http://erxes.acneskindisorder.com/widgets
API_URL=http://erxes.acneskindisorder.com/api
API_SUBSCRIPTIONS_URL=ws://erxes.acneskindisorder.com/api/subscriptions
```

```bash
yarn build
```

### Configure erxes-api/logger

```bash
cd ~/erxes/erxes-api/logger
yarn install
cp .env.sample .env
vim .env
cat .env
```

```
PORT=3800
MONGO_URL=mongodb://localhost/erxes_logs
# RabbitMQ
RABBITMQ_HOST=amqp://localhost
```

[VERIFY THIS]
(# RabbitMQ
RABBITMQ_HOST=amqp://localhost)

```bash
yarn build
```

### Configure erxes-api/email-verifier

```bash
cd ~/erxes/erxes-api/email-verifier
yarn install
cp .env.sample .env

vim .env
```

- change to production

```bash
cat .env
```

- results:

```
NODE_ENV=production
PORT=4100

# MongoDB
MONGO_URL=mongodb://localhost/erxes-email-verifier

# RabbitMQ
RABBITMQ_HOST=amqp://localhost

TRUE_MAIL_API_KEY=

```

```
yarn build
```

### configure erxes-api/engages-email-sender

```
cd ~/erxes/erxes-api/engages-email-sender
yarn install
cp .env.sample .env
vim .env
```

- change to production and add url .../api

```
cat .env
```

- results in

```
# general
NODE_ENV=production
PORT=3900

# public urls
MAIN_API_DOMAIN=http://erxes.acneskindisorder.com/api

# MongoDB
MONGO_URL=mongodb://localhost/erxes-engages
TEST_MONGO_URL=mongodb://localhost/erxes-engages-test

# RabbitMQ
RABBITMQ_HOST=amqp://localhost

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

```

```
yarn build
```

### configure erxes-api/elkSyncer

```bash
cd ~/erxes/erxes-api/elkSyncer
curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
sudo apt-get install python3-distutils

add password erxes123
y to continue

python3 get-pip.py
```

### ~/.bashrc => PATH="$HOME/.local/bin:$PATH"

```
vim ~/.bashrc
```

```
PATH="$HOME/.local/bin:$PATH"
```

- then save

- issue the following in the terminal

```bash
PATH="$HOME/.local/bin:$PATH"
export PATH
```

- install these

```
pip3 install -r requirements.txt
cp .env.sample .env
vim .env
```

- verify with

```
cat .env
```

- results / output

```
MONGO_URL=mongodb://mongo/erxes
ELASTICSEARCH_URL=http://localhost:9200
```

- then build

```
yarn build
```

### configure erxes-api

```
cd ~/erxes/erxes-api
yarn install
cp .env.sample .env
vim .env
```

```
yarn build
```

### configure erxes-integrations

```
cd ~/erxes/erxes-integrations
vim package.json
"node": "10.x.x" => "node": ">=10.x.x"
```

```
yarn install
cp .env.sample .env
vim .env
cat .env
```

- output

```
NODE_ENV=production
PORT=3400
MONGO_URL=mongodb://localhost/erxes_integrations

# Redis

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# RABBITMQ

RABBITMQ_HOST=amqp://localhost

# public facing domains

DOMAIN=http://erxes.acneskindisorder.com/integrations

# erxes non public domains

MAIN_APP_DOMAIN=http://erxes.acneskindisorder.com
MAIN_API_DOMAIN=http://erxes.acneskindisorder.com/api

```

- then build

```
yarn build
```

### widgets

```
cd ~/erxes/erxes/widgets
pm2 start dist --name widgets
```

### logger

```
cd ~/erxes/erxes-api/logger
pm2 start dist --name logger
```

### email-verifier

```
cd ~/erxes/erxes-api/email-verifier
pm2 start dist --name email-verifier
```

### engages-email-sender

```
cd ~/erxes/erxes-api/engages-email-sender
pm2 start dist --name engages-email-sender
```

### elkSyncer [THIS IS BUGGED. NEEDS TO BE STOPPED]

```
cd ~/erxes/erxes-api/elkSyncer
pm2 start main.py --name elkSyncer --interpreter python3
```

### api

```
cd ~/erxes/erxes-api
pm2 start dist --name erxes-api
pm2 start dist/cronJobs --name erxes-crons
pm2 start dist/workers --name erxes-workers
```

### erxes-integrations

```
cd ~/erxes/erxes-integrations
pm2 start dist --name erxes-integrations
```

### Nginx config

```
sudo vim /etc/nginx/sites-enabled/erxes.conf
```

- copy paste nginx config

```
sudo nginx -t
sudo service nginx reload
```

```
server {
        listen 80;

        server_name erxes.kaidawei.com;

        # erxes build path
        root /home/erxes/erxes/erxes/ui/build;
        index index.html;

        error_log /var/log/nginx/erxes.error.log;
        access_log /var/log/nginx/erxes.access.log;

        location / {
                try_files $uri /index.html;
        }

        # widgets is running on 3200 port.
        location /widgets/ {
                proxy_pass http://127.0.0.1:3200/;
                proxy_set_header Host $http_host;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_http_version 1.1;
        }

        # api project is running on 3300 port.
        location /api/ {
                proxy_pass http://127.0.0.1:3300/;
                proxy_set_header Host $http_host;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_http_version 1.1;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "Upgrade";
        }
        # erxes integrations project is running on 3400 port.
        location /integrations/ {
                proxy_pass http://127.0.0.1:3400/;
                proxy_set_header Host $http_host;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_http_version 1.1;
        }
}
```

- initialize Erxes

```bash
cd ~/erxes/erxes-api
yarn initProject
yarn loadPermission
```

</TabItem>

</Tabs>

{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/erxes-notifications","imported":["Notifications"],"specifiers":[{"kind":"named","imported":"Notifications","local":"Notifications"}]},{"source":"react-komposer","imported":["compose"],"specifiers":[{"kind":"named","imported":"compose","local":"compose"}]},{"source":"/imports/react-ui/utils","imported":["getTrackerLoader","composerOptions"],"specifiers":[{"kind":"named","imported":"getTrackerLoader","local":"getTrackerLoader"},{"kind":"named","imported":"composerOptions","local":"composerOptions"}]},{"source":"/imports/react-ui/common","imported":["pagination"],"specifiers":[{"kind":"named","imported":"pagination","local":"pagination"}]},{"source":"../../components","imported":["NotificationList"],"specifiers":[{"kind":"named","imported":"NotificationList","local":"NotificationList"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/react-ui/layout/containers/Notifications/NotificationList.js","filenameRelative":"/imports/react-ui/layout/containers/Notifications/NotificationList.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/react-ui/layout/containers/Notifications/NotificationList.js.map","sourceFileName":"/imports/react-ui/layout/containers/Notifications/NotificationList.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"NotificationList"},"ignored":false,"code":"var Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Notifications = void 0;\nmodule.importSync(\"meteor/erxes-notifications\", {\n  Notifications: function (v) {\n    Notifications = v;\n  }\n}, 1);\nvar compose = void 0;\nmodule.importSync(\"react-komposer\", {\n  compose: function (v) {\n    compose = v;\n  }\n}, 2);\nvar getTrackerLoader = void 0,\n    composerOptions = void 0;\nmodule.importSync(\"/imports/react-ui/utils\", {\n  getTrackerLoader: function (v) {\n    getTrackerLoader = v;\n  },\n  composerOptions: function (v) {\n    composerOptions = v;\n  }\n}, 3);\nvar pagination = void 0;\nmodule.importSync(\"/imports/react-ui/common\", {\n  pagination: function (v) {\n    pagination = v;\n  }\n}, 4);\nvar NotificationList = void 0;\nmodule.importSync(\"../../components\", {\n  NotificationList: function (v) {\n    NotificationList = v;\n  }\n}, 5);\n\nfunction composer(_ref, onData) {\n  var queryParams = _ref.queryParams;\n\n  var _pagination = pagination(queryParams, 'notifications.list.count'),\n      limit = _pagination.limit,\n      loadMore = _pagination.loadMore,\n      hasMore = _pagination.hasMore;\n\n  var handler = Meteor.subscribe('notifications.latest', {\n    limit: limit,\n    requireRead: false\n  });\n\n  var markAsRead = function (ids, callback) {\n    Meteor.call('notifications.markAsRead', ids, callback);\n  };\n\n  if (handler.ready()) {\n    var createdUserIds = [];\n    var notifications = Notifications.find({}, {\n      sort: {\n        date: -1\n      }\n    }).fetch();\n    notifications.forEach(function (notification) {\n      createdUserIds.push(notification.createdUser);\n    });\n    Meteor.subscribe('users.list', {\n      ids: createdUserIds\n    });\n    onData(null, {\n      notifications: notifications,\n      markAsRead: markAsRead,\n      loadMore: loadMore,\n      hasMore: hasMore\n    });\n  }\n}\n\nmodule.export(\"default\", exports.default = compose(getTrackerLoader(composer), composerOptions({}))(NotificationList));","map":{"version":3,"sources":["/imports/react-ui/layout/containers/Notifications/NotificationList.js"],"names":["Meteor","module","importSync","v","Notifications","compose","getTrackerLoader","composerOptions","pagination","NotificationList","composer","onData","queryParams","limit","loadMore","hasMore","handler","subscribe","requireRead","markAsRead","ids","callback","call","ready","createdUserIds","notifications","find","sort","date","fetch","forEach","push","notification","createdUser","export","exports","default"],"mappings":"AAAA,IAAIA,eAAJ;AAAWC,OAAOC,UAAP,CAAkB,eAAlB,EAAkC;AAACF,UAAO,UAASG,CAAT,EAAW;AAACH,aAAOG,CAAP;AAAS;AAA7B,CAAlC,EAAiE,CAAjE;AAAoE,IAAIC,sBAAJ;AAAkBH,OAAOC,UAAP,CAAkB,4BAAlB,EAA+C;AAACE,iBAAc,UAASD,CAAT,EAAW;AAACC,oBAAcD,CAAd;AAAgB;AAA3C,CAA/C,EAA4F,CAA5F;AAA+F,IAAIE,gBAAJ;AAAYJ,OAAOC,UAAP,CAAkB,gBAAlB,EAAmC;AAACG,WAAQ,UAASF,CAAT,EAAW;AAACE,cAAQF,CAAR;AAAU;AAA/B,CAAnC,EAAoE,CAApE;AAAuE,IAAIG,yBAAJ;AAAA,IAAqBC,wBAArB;AAAqCN,OAAOC,UAAP,CAAkB,yBAAlB,EAA4C;AAACI,oBAAiB,UAASH,CAAT,EAAW;AAACG,uBAAiBH,CAAjB;AAAmB,GAAjD;AAAkDI,mBAAgB,UAASJ,CAAT,EAAW;AAACI,sBAAgBJ,CAAhB;AAAkB;AAAhG,CAA5C,EAA8I,CAA9I;AAAiJ,IAAIK,mBAAJ;AAAeP,OAAOC,UAAP,CAAkB,0BAAlB,EAA6C;AAACM,cAAW,UAASL,CAAT,EAAW;AAACK,iBAAWL,CAAX;AAAa;AAArC,CAA7C,EAAoF,CAApF;AAAuF,IAAIM,yBAAJ;AAAqBR,OAAOC,UAAP,CAAkB,kBAAlB,EAAqC;AAACO,oBAAiB,UAASN,CAAT,EAAW;AAACM,uBAAiBN,CAAjB;AAAmB;AAAjD,CAArC,EAAwF,CAAxF;;AAOpkB,SAASO,QAAT,OAAmCC,MAAnC,EAA2C;AAAA,MAAvBC,WAAuB,QAAvBA,WAAuB;;AAAA,oBACJJ,WAAWI,WAAX,EAAwB,0BAAxB,CADI;AAAA,MACjCC,KADiC,eACjCA,KADiC;AAAA,MAC1BC,QAD0B,eAC1BA,QAD0B;AAAA,MAChBC,OADgB,eAChBA,OADgB;;AAGzC,MAAMC,UAAUhB,OAAOiB,SAAP,CAAiB,sBAAjB,EAAyC;AACvDJ,gBADuD;AAEvDK,iBAAa;AAF0C,GAAzC,CAAhB;;AAKA,MAAMC,aAAa,UAACC,GAAD,EAAMC,QAAN,EAAmB;AACpCrB,WAAOsB,IAAP,CAAY,0BAAZ,EAAwCF,GAAxC,EAA6CC,QAA7C;AACD,GAFD;;AAIA,MAAIL,QAAQO,KAAR,EAAJ,EAAqB;AACnB,QAAMC,iBAAiB,EAAvB;AACA,QAAMC,gBAAgBrB,cAAcsB,IAAd,CAAmB,EAAnB,EAAuB;AAAEC,YAAM;AAAEC,cAAM,CAAC;AAAT;AAAR,KAAvB,EAA+CC,KAA/C,EAAtB;AAEAJ,kBAAcK,OAAd,CAAsB,wBAAgB;AACpCN,qBAAeO,IAAf,CAAoBC,aAAaC,WAAjC;AACD,KAFD;AAIAjC,WAAOiB,SAAP,CAAiB,YAAjB,EAA+B;AAAEG,WAAKI;AAAP,KAA/B;AAEAb,WAAO,IAAP,EAAa;AAAEc,kCAAF;AAAiBN,4BAAjB;AAA6BL,wBAA7B;AAAuCC;AAAvC,KAAb;AACD;AACF;;AA/BDd,OAAOiC,MAAP,CAAc,SAAd,EAAwBC,QAAQC,OAAR,GAiCT/B,QAAQC,iBAAiBI,QAAjB,CAAR,EAAoCH,gBAAgB,EAAhB,CAApC,EAAyDE,gBAAzD,CAjCf","file":"/imports/react-ui/layout/containers/Notifications/NotificationList.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Notifications } from 'meteor/erxes-notifications';\nimport { compose } from 'react-komposer';\nimport { getTrackerLoader, composerOptions } from '/imports/react-ui/utils';\nimport { pagination } from '/imports/react-ui/common';\nimport { NotificationList } from '../../components';\n\nfunction composer({ queryParams }, onData) {\n  const { limit, loadMore, hasMore } = pagination(queryParams, 'notifications.list.count');\n\n  const handler = Meteor.subscribe('notifications.latest', {\n    limit,\n    requireRead: false,\n  });\n\n  const markAsRead = (ids, callback) => {\n    Meteor.call('notifications.markAsRead', ids, callback);\n  };\n\n  if (handler.ready()) {\n    const createdUserIds = [];\n    const notifications = Notifications.find({}, { sort: { date: -1 } }).fetch();\n\n    notifications.forEach(notification => {\n      createdUserIds.push(notification.createdUser);\n    });\n\n    Meteor.subscribe('users.list', { ids: createdUserIds });\n\n    onData(null, { notifications, markAsRead, loadMore, hasMore });\n  }\n}\n\nexport default compose(getTrackerLoader(composer), composerOptions({}))(NotificationList);\n"]},"hash":"db4e41dcd95860011ff96d212dbef99961136442"}

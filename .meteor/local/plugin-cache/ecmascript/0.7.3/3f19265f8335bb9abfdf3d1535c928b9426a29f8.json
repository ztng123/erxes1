{"metadata":{"usedHelpers":["toConsumableArray","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"react-komposer","imported":["compose"],"specifiers":[{"kind":"named","imported":"compose","local":"compose"}]},{"source":"meteor/erxes-notifier","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Alert"}]},{"source":"/imports/react-ui/utils","imported":["getTrackerLoader"],"specifiers":[{"kind":"named","imported":"getTrackerLoader","local":"getTrackerLoader"}]},{"source":"../components","imported":["InternalNotes"],"specifiers":[{"kind":"named","imported":"InternalNotes","local":"InternalNotes"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/react-ui/customers/containers/InternalNotes.js","filenameRelative":"/imports/react-ui/customers/containers/InternalNotes.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/react-ui/customers/containers/InternalNotes.js.map","sourceFileName":"/imports/react-ui/customers/containers/InternalNotes.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"InternalNotes"},"ignored":false,"code":"var _toConsumableArray2 = require(\"babel-runtime/helpers/toConsumableArray\");\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar compose = void 0;\nmodule.importSync(\"react-komposer\", {\n  compose: function (v) {\n    compose = v;\n  }\n}, 1);\nvar Alert = void 0;\nmodule.importSync(\"meteor/erxes-notifier\", {\n  \"default\": function (v) {\n    Alert = v;\n  }\n}, 2);\nvar getTrackerLoader = void 0;\nmodule.importSync(\"/imports/react-ui/utils\", {\n  getTrackerLoader: function (v) {\n    getTrackerLoader = v;\n  }\n}, 3);\nvar InternalNotes = void 0;\nmodule.importSync(\"../components\", {\n  InternalNotes: function (v) {\n    InternalNotes = v;\n  }\n}, 4);\n\nfunction composer(_ref, onData) {\n  var customer = _ref.customer;\n  var internalNotes = [].concat((0, _toConsumableArray3.default)(customer.internalNotes || []));\n\n  if (internalNotes) {\n    internalNotes.sort(function (a, b) {\n      return b.createdDate - a.createdDate;\n    });\n  }\n\n  onData(null, {\n    internalNotes: internalNotes || [],\n    createInternalNote: function (content) {\n      var doc = {\n        customerId: customer._id,\n        internalNote: content\n      };\n      Meteor.call('customers.createInternalNote', doc, function () {\n        customer.refetch();\n      });\n    },\n    removeInternalNote: function (internalNoteId) {\n      var doc = {\n        customerId: customer._id,\n        internalNoteId: internalNoteId\n      };\n      Meteor.call('customers.removeInternalNote', doc, function (error) {\n        if (error) {\n          return Alert.error(error.message);\n        }\n\n        customer.refetch();\n      });\n    }\n  });\n}\n\nmodule.export(\"default\", exports.default = compose(getTrackerLoader(composer))(InternalNotes));","map":{"version":3,"sources":["/imports/react-ui/customers/containers/InternalNotes.js"],"names":["Meteor","module","importSync","v","compose","Alert","getTrackerLoader","InternalNotes","composer","onData","customer","internalNotes","sort","a","b","createdDate","createInternalNote","doc","customerId","_id","internalNote","content","call","refetch","removeInternalNote","internalNoteId","error","message","export","exports","default"],"mappings":";;;;;;AAAA,IAAIA,eAAJ;AAAWC,OAAOC,UAAP,CAAkB,eAAlB,EAAkC;AAACF,UAAO,UAASG,CAAT,EAAW;AAACH,aAAOG,CAAP;AAAS;AAA7B,CAAlC,EAAiE,CAAjE;AAAoE,IAAIC,gBAAJ;AAAYH,OAAOC,UAAP,CAAkB,gBAAlB,EAAmC;AAACE,WAAQ,UAASD,CAAT,EAAW;AAACC,cAAQD,CAAR;AAAU;AAA/B,CAAnC,EAAoE,CAApE;AAAuE,IAAIE,cAAJ;AAAUJ,OAAOC,UAAP,CAAkB,uBAAlB,EAA0C;AAAC,aAAQ,UAASC,CAAT,EAAW;AAACE,YAAMF,CAAN;AAAQ;AAA7B,CAA1C,EAAyE,CAAzE;AAA4E,IAAIG,yBAAJ;AAAqBL,OAAOC,UAAP,CAAkB,yBAAlB,EAA4C;AAACI,oBAAiB,UAASH,CAAT,EAAW;AAACG,uBAAiBH,CAAjB;AAAmB;AAAjD,CAA5C,EAA+F,CAA/F;AAAkG,IAAII,sBAAJ;AAAkBN,OAAOC,UAAP,CAAkB,eAAlB,EAAkC;AAACK,iBAAc,UAASJ,CAAT,EAAW;AAACI,oBAAcJ,CAAd;AAAgB;AAA3C,CAAlC,EAA+E,CAA/E;;AAMjY,SAASK,QAAT,OAAgCC,MAAhC,EAAwC;AAAA,MAApBC,QAAoB,QAApBA,QAAoB;AACtC,MAAMC,2DAAqBD,SAASC,aAAT,IAA0B,EAA/C,EAAN;;AAEA,MAAIA,aAAJ,EAAmB;AACjBA,kBAAcC,IAAd,CAAmB,UAACC,CAAD,EAAIC,CAAJ;AAAA,aAAUA,EAAEC,WAAF,GAAgBF,EAAEE,WAA5B;AAAA,KAAnB;AACD;;AAEDN,SAAO,IAAP,EAAa;AACXE,mBAAeA,iBAAiB,EADrB;AAGXK,wBAAoB,mBAAW;AAC7B,UAAMC,MAAM;AAAEC,oBAAYR,SAASS,GAAvB;AAA4BC,sBAAcC;AAA1C,OAAZ;AACArB,aAAOsB,IAAP,CAAY,8BAAZ,EAA4CL,GAA5C,EAAiD,YAAM;AACrDP,iBAASa,OAAT;AACD,OAFD;AAGD,KARU;AAUXC,wBAAoB,0BAAkB;AACpC,UAAMP,MAAM;AAAEC,oBAAYR,SAASS,GAAvB;AAA4BM;AAA5B,OAAZ;AAEAzB,aAAOsB,IAAP,CAAY,8BAAZ,EAA4CL,GAA5C,EAAiD,iBAAS;AACxD,YAAIS,KAAJ,EAAW;AACT,iBAAOrB,MAAMqB,KAAN,CAAYA,MAAMC,OAAlB,CAAP;AACD;;AAEDjB,iBAASa,OAAT;AACD,OAND;AAOD;AApBU,GAAb;AAsBD;;AAnCDtB,OAAO2B,MAAP,CAAc,SAAd,EAAwBC,QAAQC,OAAR,GAqCT1B,QAAQE,iBAAiBE,QAAjB,CAAR,EAAoCD,aAApC,CArCf","file":"/imports/react-ui/customers/containers/InternalNotes.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { compose } from 'react-komposer';\nimport Alert from 'meteor/erxes-notifier';\nimport { getTrackerLoader } from '/imports/react-ui/utils';\nimport { InternalNotes } from '../components';\n\nfunction composer({ customer }, onData) {\n  const internalNotes = [...(customer.internalNotes || [])];\n\n  if (internalNotes) {\n    internalNotes.sort((a, b) => b.createdDate - a.createdDate);\n  }\n\n  onData(null, {\n    internalNotes: internalNotes || [],\n\n    createInternalNote: content => {\n      const doc = { customerId: customer._id, internalNote: content };\n      Meteor.call('customers.createInternalNote', doc, () => {\n        customer.refetch();\n      });\n    },\n\n    removeInternalNote: internalNoteId => {\n      const doc = { customerId: customer._id, internalNoteId };\n\n      Meteor.call('customers.removeInternalNote', doc, error => {\n        if (error) {\n          return Alert.error(error.message);\n        }\n\n        customer.refetch();\n      });\n    },\n  });\n}\n\nexport default compose(getTrackerLoader(composer))(InternalNotes);\n"]},"hash":"3f19265f8335bb9abfdf3d1535c928b9426a29f8"}

{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/percolate:synced-cron","imported":["SyncedCron"],"specifiers":[{"kind":"named","imported":"SyncedCron","local":"SyncedCron"}]},{"source":"/imports/api/engage/engage","imported":["Messages"],"specifiers":[{"kind":"named","imported":"Messages","local":"Messages"}]},{"source":"/imports/api/engage/utils","imported":["send"],"specifiers":[{"kind":"named","imported":"send","local":"send"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/api/engage/server/cronJobs.js","filenameRelative":"/imports/api/engage/server/cronJobs.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/api/engage/server/cronJobs.js.map","sourceFileName":"/imports/api/engage/server/cronJobs.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"cronJobs"},"ignored":false,"code":"var SyncedCron = void 0;\nmodule.importSync(\"meteor/percolate:synced-cron\", {\n  SyncedCron: function (v) {\n    SyncedCron = v;\n  }\n}, 0);\nvar Messages = void 0;\nmodule.importSync(\"/imports/api/engage/engage\", {\n  Messages: function (v) {\n    Messages = v;\n  }\n}, 1);\nvar send = void 0;\nmodule.importSync(\"/imports/api/engage/utils\", {\n  send: function (v) {\n    send = v;\n  }\n}, 2);\n\nvar sendAutoMessage = function () {\n  return Messages.find({\n    kind: 'auto',\n    isLive: true\n  }).forEach(function (message) {\n    return send(message);\n  });\n};\n\nSyncedCron.add({\n  name: 'Send auto messages',\n  schedule: function (parser) {\n    return parser.text('every day at 11pm');\n  },\n  job: function () {\n    sendAutoMessage();\n  }\n});","map":{"version":3,"sources":["/imports/api/engage/server/cronJobs.js"],"names":["SyncedCron","module","importSync","v","Messages","send","sendAutoMessage","find","kind","isLive","forEach","message","add","name","schedule","parser","text","job"],"mappings":"AAAA,IAAIA,mBAAJ;AAAeC,OAAOC,UAAP,CAAkB,8BAAlB,EAAiD;AAACF,cAAW,UAASG,CAAT,EAAW;AAACH,iBAAWG,CAAX;AAAa;AAArC,CAAjD,EAAwF,CAAxF;AAA2F,IAAIC,iBAAJ;AAAaH,OAAOC,UAAP,CAAkB,4BAAlB,EAA+C;AAACE,YAAS,UAASD,CAAT,EAAW;AAACC,eAASD,CAAT;AAAW;AAAjC,CAA/C,EAAkF,CAAlF;AAAqF,IAAIE,aAAJ;AAASJ,OAAOC,UAAP,CAAkB,2BAAlB,EAA8C;AAACG,QAAK,UAASF,CAAT,EAAW;AAACE,WAAKF,CAAL;AAAO;AAAzB,CAA9C,EAAyE,CAAzE;;AAIrN,IAAMG,kBAAkB;AAAA,SACtBF,SAASG,IAAT,CAAc;AAAEC,UAAM,MAAR;AAAgBC,YAAQ;AAAxB,GAAd,EAA8CC,OAA9C,CAAsD;AAAA,WAAWL,KAAKM,OAAL,CAAX;AAAA,GAAtD,CADsB;AAAA,CAAxB;;AAGAX,WAAWY,GAAX,CAAe;AACbC,QAAM,oBADO;AAGbC,UAHa,YAGJC,MAHI,EAGI;AACf,WAAOA,OAAOC,IAAP,CAAY,mBAAZ,CAAP;AACD,GALY;AAObC,KAPa,cAOP;AACJX;AACD;AATY,CAAf","file":"/imports/api/engage/server/cronJobs.js.map","sourcesContent":["import { SyncedCron } from 'meteor/percolate:synced-cron';\nimport { Messages } from '/imports/api/engage/engage';\nimport { send } from '/imports/api/engage/utils';\n\nconst sendAutoMessage = () =>\n  Messages.find({ kind: 'auto', isLive: true }).forEach(message => send(message));\n\nSyncedCron.add({\n  name: 'Send auto messages',\n\n  schedule(parser) {\n    return parser.text('every day at 11pm');\n  },\n\n  job() {\n    sendAutoMessage();\n  },\n});\n"]},"hash":"f59fe7402eeb80d034222cc6c9a36b25a6b956f9"}

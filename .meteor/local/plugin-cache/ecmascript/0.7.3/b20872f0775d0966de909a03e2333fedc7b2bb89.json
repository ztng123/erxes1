{"metadata":{"usedHelpers":["extends","taggedTemplateLiteralLoose","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/underscore","imported":["_"],"specifiers":[{"kind":"named","imported":"_","local":"_"}]},{"source":"react","imported":["default","PropTypes"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"PropTypes","local":"PropTypes"}]},{"source":"react-apollo","imported":["compose","gql","graphql"],"specifiers":[{"kind":"named","imported":"compose","local":"compose"},{"kind":"named","imported":"gql","local":"gql"},{"kind":"named","imported":"graphql","local":"graphql"}]},{"source":"../components","imported":["Signature"],"specifiers":[{"kind":"named","imported":"Signature","local":"Signature"}]},{"source":"/imports/react-ui/common","imported":["Loading"],"specifiers":[{"kind":"named","imported":"Loading","local":"Loading"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/react-ui/settings/email/containers/Signature.js","filenameRelative":"/imports/react-ui/settings/email/containers/Signature.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/react-ui/settings/email/containers/Signature.js.map","sourceFileName":"/imports/react-ui/settings/email/containers/Signature.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"Signature"},"ignored":false,"code":"var _taggedTemplateLiteralLoose2 = require(\"babel-runtime/helpers/taggedTemplateLiteralLoose\");\n\nvar _taggedTemplateLiteralLoose3 = _interopRequireDefault(_taggedTemplateLiteralLoose2);\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _this = this;\n\nvar _templateObject = (0, _taggedTemplateLiteralLoose3.default)([\"\\n      query objects($limit: Int) {\\n        brands(limit: $limit) {\\n          _id\\n          name\\n        }\\n      }\\n    \"], [\"\\n      query objects($limit: Int) {\\n        brands(limit: $limit) {\\n          _id\\n          name\\n        }\\n      }\\n    \"]);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\n\nvar _ = void 0;\n\nmodule.importSync(\"meteor/underscore\", {\n  _: function (v) {\n    _ = v;\n  }\n}, 1);\nvar React = void 0,\n    PropTypes = void 0;\nmodule.importSync(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  PropTypes: function (v) {\n    PropTypes = v;\n  }\n}, 2);\nvar compose = void 0,\n    gql = void 0,\n    graphql = void 0;\nmodule.importSync(\"react-apollo\", {\n  compose: function (v) {\n    compose = v;\n  },\n  gql: function (v) {\n    gql = v;\n  },\n  graphql: function (v) {\n    graphql = v;\n  }\n}, 3);\nvar Signature = void 0;\nmodule.importSync(\"../components\", {\n  Signature: function (v) {\n    Signature = v;\n  }\n}, 4);\nvar Loading = void 0;\nmodule.importSync(\"/imports/react-ui/common\", {\n  Loading: function (v) {\n    Loading = v;\n  }\n}, 5);\n\nvar SignatureContainer = function (props) {\n  var brandsQuery = props.brandsQuery;\n\n  if (brandsQuery.loading) {\n    return React.createElement(Loading, {\n      title: \"Signature template\"\n    });\n  } // save email configs action\n\n\n  var save = function (signatures, callback) {\n    var doc = []; // remove brandName from list\n\n    _.each(signatures, function (signature) {\n      doc.push({\n        brandId: signature.brandId,\n        signature: signature.content\n      });\n    });\n\n    Meteor.call('users.configEmailSignature', {\n      signatures: doc\n    }, function () {\n      callback.apply(undefined, arguments);\n    });\n  };\n\n  var currentUser = Meteor.user();\n  var emailSignatures = currentUser.emailSignatures || [];\n  var signatures = [];\n  brandsQuery.brands.forEach(function (brand) {\n    // previously configured signature\n    var oldEntry = emailSignatures.find(function (signature) {\n      return signature.brandId === brand._id;\n    }); // default content\n\n    var content = '';\n\n    if (oldEntry) {\n      content = oldEntry.signature;\n    }\n\n    signatures.push({\n      brandId: brand._id,\n      brandName: brand.name,\n      content: content\n    });\n  });\n  var updatedProps = (0, _extends3.default)({}, _this.props, {\n    signatures: signatures,\n    save: save\n  });\n  return React.createElement(Signature, updatedProps);\n};\n\nSignatureContainer.propTypes = {\n  brandsQuery: PropTypes.object\n};\nmodule.export(\"default\", exports.default = compose(graphql(gql(_templateObject), {\n  name: 'brandsQuery'\n}))(SignatureContainer));","map":{"version":3,"sources":["/imports/react-ui/settings/email/containers/Signature.js"],"names":["Meteor","module","importSync","v","_","React","PropTypes","compose","gql","graphql","Signature","Loading","SignatureContainer","brandsQuery","props","loading","save","signatures","callback","doc","each","push","brandId","signature","content","call","currentUser","user","emailSignatures","brands","forEach","oldEntry","find","brand","_id","brandName","name","updatedProps","propTypes","object","export","exports","default"],"mappings":";;;;;;;;;;;;;;AAAA,IAAIA,eAAJ;AAAWC,OAAOC,UAAP,CAAkB,eAAlB,EAAkC;AAACF,UAAO,UAASG,CAAT,EAAW;AAACH,aAAOG,CAAP;AAAS;AAA7B,CAAlC,EAAiE,CAAjE;;AAAoE,IAAIC,UAAJ;;AAAMH,OAAOC,UAAP,CAAkB,mBAAlB,EAAsC;AAACE,KAAE,UAASD,CAAT,EAAW;AAACC,QAAED,CAAF;AAAI;AAAnB,CAAtC,EAA2D,CAA3D;AAA8D,IAAIE,cAAJ;AAAA,IAAUC,kBAAV;AAAoBL,OAAOC,UAAP,CAAkB,OAAlB,EAA0B;AAAC,aAAQ,UAASC,CAAT,EAAW;AAACE,YAAMF,CAAN;AAAQ,GAA7B;AAA8BG,aAAU,UAASH,CAAT,EAAW;AAACG,gBAAUH,CAAV;AAAY;AAAhE,CAA1B,EAA4F,CAA5F;AAA+F,IAAII,gBAAJ;AAAA,IAAYC,YAAZ;AAAA,IAAgBC,gBAAhB;AAAwBR,OAAOC,UAAP,CAAkB,cAAlB,EAAiC;AAACK,WAAQ,UAASJ,CAAT,EAAW;AAACI,cAAQJ,CAAR;AAAU,GAA/B;AAAgCK,OAAI,UAASL,CAAT,EAAW;AAACK,UAAIL,CAAJ;AAAM,GAAtD;AAAuDM,WAAQ,UAASN,CAAT,EAAW;AAACM,cAAQN,CAAR;AAAU;AAArF,CAAjC,EAAwH,CAAxH;AAA2H,IAAIO,kBAAJ;AAAcT,OAAOC,UAAP,CAAkB,eAAlB,EAAkC;AAACQ,aAAU,UAASP,CAAT,EAAW;AAACO,gBAAUP,CAAV;AAAY;AAAnC,CAAlC,EAAuE,CAAvE;AAA0E,IAAIQ,gBAAJ;AAAYV,OAAOC,UAAP,CAAkB,0BAAlB,EAA6C;AAACS,WAAQ,UAASR,CAAT,EAAW;AAACQ,cAAQR,CAAR;AAAU;AAA/B,CAA7C,EAA8E,CAA9E;;AAO7f,IAAMS,qBAAqB,iBAAS;AAAA,MAC1BC,WAD0B,GACVC,KADU,CAC1BD,WAD0B;;AAGlC,MAAIA,YAAYE,OAAhB,EAAyB;AACvB,WAAO,oBAAC,OAAD;AAAS,aAAM;AAAf,MAAP;AACD,GALiC,CAOlC;;;AACA,MAAMC,OAAO,UAACC,UAAD,EAAaC,QAAb,EAA0B;AACrC,QAAMC,MAAM,EAAZ,CADqC,CAGrC;;AACAf,MAAEgB,IAAF,CAAOH,UAAP,EAAmB,qBAAa;AAC9BE,UAAIE,IAAJ,CAAS;AACPC,iBAASC,UAAUD,OADZ;AAEPC,mBAAWA,UAAUC;AAFd,OAAT;AAID,KALD;;AAOAxB,WAAOyB,IAAP,CAAY,4BAAZ,EAA0C;AAAER,kBAAYE;AAAd,KAA1C,EAA+D,YAAe;AAC5ED;AACD,KAFD;AAGD,GAdD;;AAgBA,MAAMQ,cAAc1B,OAAO2B,IAAP,EAApB;AACA,MAAMC,kBAAkBF,YAAYE,eAAZ,IAA+B,EAAvD;AACA,MAAMX,aAAa,EAAnB;AAEAJ,cAAYgB,MAAZ,CAAmBC,OAAnB,CAA2B,iBAAS;AAClC;AACA,QAAMC,WAAWH,gBAAgBI,IAAhB,CAAqB;AAAA,aAAaT,UAAUD,OAAV,KAAsBW,MAAMC,GAAzC;AAAA,KAArB,CAAjB,CAFkC,CAIlC;;AACA,QAAIV,UAAU,EAAd;;AAEA,QAAIO,QAAJ,EAAc;AACZP,gBAAUO,SAASR,SAAnB;AACD;;AAEDN,eAAWI,IAAX,CAAgB;AACdC,eAASW,MAAMC,GADD;AAEdC,iBAAWF,MAAMG,IAFH;AAGdZ;AAHc,KAAhB;AAKD,GAhBD;AAkBA,MAAMa,0CACD,MAAKvB,KADJ;AAEJG,0BAFI;AAGJD;AAHI,IAAN;AAMA,SAAO,oBAAC,SAAD,EAAeqB,YAAf,CAAP;AACD,CArDD;;AAuDAzB,mBAAmB0B,SAAnB,GAA+B;AAC7BzB,eAAaP,UAAUiC;AADM,CAA/B;AA9DAtC,OAAOuC,MAAP,CAAc,SAAd,EAAwBC,QAAQC,OAAR,GAkETnC,QACbE,QACED,GADF,mBASE;AACE4B,QAAM;AADR,CATF,CADa,EAcbxB,kBAda,CAlEf","file":"/imports/react-ui/settings/email/containers/Signature.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { _ } from 'meteor/underscore';\nimport React, { PropTypes } from 'react';\nimport { compose, gql, graphql } from 'react-apollo';\nimport { Signature } from '../components';\nimport { Loading } from '/imports/react-ui/common';\n\nconst SignatureContainer = props => {\n  const { brandsQuery } = props;\n\n  if (brandsQuery.loading) {\n    return <Loading title=\"Signature template\" />;\n  }\n\n  // save email configs action\n  const save = (signatures, callback) => {\n    const doc = [];\n\n    // remove brandName from list\n    _.each(signatures, signature => {\n      doc.push({\n        brandId: signature.brandId,\n        signature: signature.content,\n      });\n    });\n\n    Meteor.call('users.configEmailSignature', { signatures: doc }, (...params) => {\n      callback(...params);\n    });\n  };\n\n  const currentUser = Meteor.user();\n  const emailSignatures = currentUser.emailSignatures || [];\n  const signatures = [];\n\n  brandsQuery.brands.forEach(brand => {\n    // previously configured signature\n    const oldEntry = emailSignatures.find(signature => signature.brandId === brand._id);\n\n    // default content\n    let content = '';\n\n    if (oldEntry) {\n      content = oldEntry.signature;\n    }\n\n    signatures.push({\n      brandId: brand._id,\n      brandName: brand.name,\n      content,\n    });\n  });\n\n  const updatedProps = {\n    ...this.props,\n    signatures,\n    save,\n  };\n\n  return <Signature {...updatedProps} />;\n};\n\nSignatureContainer.propTypes = {\n  brandsQuery: PropTypes.object,\n};\n\nexport default compose(\n  graphql(\n    gql`\n      query objects($limit: Int) {\n        brands(limit: $limit) {\n          _id\n          name\n        }\n      }\n    `,\n    {\n      name: 'brandsQuery',\n    },\n  ),\n)(SignatureContainer);\n"]},"hash":"b20872f0775d0966de909a03e2333fedc7b2bb89"}

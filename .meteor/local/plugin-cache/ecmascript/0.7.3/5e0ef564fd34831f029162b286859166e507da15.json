{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/ddp-rate-limiter","imported":["DDPRateLimiter"],"specifiers":[{"kind":"named","imported":"DDPRateLimiter","local":"DDPRateLimiter"}]},{"source":"meteor/underscore","imported":["_"],"specifiers":[{"kind":"named","imported":"_","local":"_"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/startup/server/security.js","filenameRelative":"/imports/startup/server/security.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/startup/server/security.js.map","sourceFileName":"/imports/startup/server/security.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"security"},"ignored":false,"code":"var Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar DDPRateLimiter = void 0;\nmodule.importSync(\"meteor/ddp-rate-limiter\", {\n  DDPRateLimiter: function (v) {\n    DDPRateLimiter = v;\n  }\n}, 1);\n\nvar _ = void 0;\n\nmodule.importSync(\"meteor/underscore\", {\n  _: function (v) {\n    _ = v;\n  }\n}, 2);\n// Don't let people write arbitrary data to their 'profile' field from the client\nMeteor.users.deny({\n  update: function () {\n    return true;\n  }\n}); // Get a list of all accounts methods by running `Meteor.server.method_handlers` in meteor shell\n\nvar AUTH_METHODS = ['login', 'logout', 'logoutOtherClients', 'getNewToken', 'removeOtherTokens', 'configureLoginService', 'changePassword', 'forgotPassword', 'resetPassword', 'verifyEmail', 'createUser', 'ATRemoveService', 'ATCreateUserServer', 'ATResendVerificationEmail'];\n\nif (Meteor.isServer) {\n  // Only allow 2 login attempts per connection per 5 seconds\n  DDPRateLimiter.addRule({\n    name: function (name) {\n      return _.contains(AUTH_METHODS, name);\n    },\n    // Rate limit per connection ID\n    connectionId: function () {\n      return true;\n    }\n  }, 2, 5000);\n}","map":{"version":3,"sources":["/imports/startup/server/security.js"],"names":["Meteor","module","importSync","v","DDPRateLimiter","_","users","deny","update","AUTH_METHODS","isServer","addRule","name","contains","connectionId"],"mappings":"AAAA,IAAIA,eAAJ;AAAWC,OAAOC,UAAP,CAAkB,eAAlB,EAAkC;AAACF,UAAO,UAASG,CAAT,EAAW;AAACH,aAAOG,CAAP;AAAS;AAA7B,CAAlC,EAAiE,CAAjE;AAAoE,IAAIC,uBAAJ;AAAmBH,OAAOC,UAAP,CAAkB,yBAAlB,EAA4C;AAACE,kBAAe,UAASD,CAAT,EAAW;AAACC,qBAAeD,CAAf;AAAiB;AAA7C,CAA5C,EAA2F,CAA3F;;AAA8F,IAAIE,UAAJ;;AAAMJ,OAAOC,UAAP,CAAkB,mBAAlB,EAAsC;AAACG,KAAE,UAASF,CAAT,EAAW;AAACE,QAAEF,CAAF;AAAI;AAAnB,CAAtC,EAA2D,CAA3D;AAItM;AACAH,OAAOM,KAAP,CAAaC,IAAb,CAAkB;AAChBC,QADgB,cACP;AACP,WAAO,IAAP;AACD;AAHe,CAAlB,E,CAMA;;AACA,IAAMC,eAAe,CACnB,OADmB,EAEnB,QAFmB,EAGnB,oBAHmB,EAInB,aAJmB,EAKnB,mBALmB,EAMnB,uBANmB,EAOnB,gBAPmB,EAQnB,gBARmB,EASnB,eATmB,EAUnB,aAVmB,EAWnB,YAXmB,EAYnB,iBAZmB,EAanB,oBAbmB,EAcnB,2BAdmB,CAArB;;AAiBA,IAAIT,OAAOU,QAAX,EAAqB;AACnB;AACAN,iBAAeO,OAAf,CACE;AACEC,QADF,YACOA,IADP,EACa;AACT,aAAOP,EAAEQ,QAAF,CAAWJ,YAAX,EAAyBG,IAAzB,CAAP;AACD,KAHH;AAKE;AACAE,gBANF,cAMiB;AACb,aAAO,IAAP;AACD;AARH,GADF,EAWE,CAXF,EAYE,IAZF;AAcD","file":"/imports/startup/server/security.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _ } from 'meteor/underscore';\n\n// Don't let people write arbitrary data to their 'profile' field from the client\nMeteor.users.deny({\n  update() {\n    return true;\n  },\n});\n\n// Get a list of all accounts methods by running `Meteor.server.method_handlers` in meteor shell\nconst AUTH_METHODS = [\n  'login',\n  'logout',\n  'logoutOtherClients',\n  'getNewToken',\n  'removeOtherTokens',\n  'configureLoginService',\n  'changePassword',\n  'forgotPassword',\n  'resetPassword',\n  'verifyEmail',\n  'createUser',\n  'ATRemoveService',\n  'ATCreateUserServer',\n  'ATResendVerificationEmail',\n];\n\nif (Meteor.isServer) {\n  // Only allow 2 login attempts per connection per 5 seconds\n  DDPRateLimiter.addRule(\n    {\n      name(name) {\n        return _.contains(AUTH_METHODS, name);\n      },\n\n      // Rate limit per connection ID\n      connectionId() {\n        return true;\n      },\n    },\n    2,\n    5000,\n  );\n}\n"]},"hash":"5e0ef564fd34831f029162b286859166e507da15"}

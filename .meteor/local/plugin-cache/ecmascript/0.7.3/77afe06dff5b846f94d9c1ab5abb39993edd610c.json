{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"react","imported":["default","Component"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"}]},{"source":"prop-types","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"PropTypes"}]},{"source":"react-bootstrap","imported":["FormGroup","ControlLabel","FormControl","Button","ButtonToolbar","Modal"],"specifiers":[{"kind":"named","imported":"FormGroup","local":"FormGroup"},{"kind":"named","imported":"ControlLabel","local":"ControlLabel"},{"kind":"named","imported":"FormControl","local":"FormControl"},{"kind":"named","imported":"Button","local":"Button"},{"kind":"named","imported":"ButtonToolbar","local":"ButtonToolbar"},{"kind":"named","imported":"Modal","local":"Modal"}]},{"source":"react-markdown","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"ReactMarkdown"}]},{"source":"react-copy-to-clipboard","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"CopyToClipboard"}]},{"source":"./SelectBrand","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"SelectBrand"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/react-ui/settings/integrations/components/Common.js","filenameRelative":"/imports/react-ui/settings/integrations/components/Common.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/react-ui/settings/integrations/components/Common.js.map","sourceFileName":"/imports/react-ui/settings/integrations/components/Common.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"Common"},"ignored":false,"code":"var _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar React = void 0,\n    Component = void 0;\nmodule.importSync(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 1);\nvar PropTypes = void 0;\nmodule.importSync(\"prop-types\", {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 2);\nvar FormGroup = void 0,\n    ControlLabel = void 0,\n    FormControl = void 0,\n    Button = void 0,\n    ButtonToolbar = void 0,\n    Modal = void 0;\nmodule.importSync(\"react-bootstrap\", {\n  FormGroup: function (v) {\n    FormGroup = v;\n  },\n  ControlLabel: function (v) {\n    ControlLabel = v;\n  },\n  FormControl: function (v) {\n    FormControl = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  ButtonToolbar: function (v) {\n    ButtonToolbar = v;\n  },\n  Modal: function (v) {\n    Modal = v;\n  }\n}, 3);\nvar ReactMarkdown = void 0;\nmodule.importSync(\"react-markdown\", {\n  \"default\": function (v) {\n    ReactMarkdown = v;\n  }\n}, 4);\nvar CopyToClipboard = void 0;\nmodule.importSync(\"react-copy-to-clipboard\", {\n  \"default\": function (v) {\n    CopyToClipboard = v;\n  }\n}, 5);\nvar SelectBrand = void 0;\nmodule.importSync(\"./SelectBrand\", {\n  \"default\": function (v) {\n    SelectBrand = v;\n  }\n}, 6);\n\nvar Common = function (_Component) {\n  (0, _inherits3.default)(Common, _Component);\n\n  Common.installCodeIncludeScript = function () {\n    function installCodeIncludeScript(type) {\n      return \"\\n      (function() {\\n        var script = document.createElement('script');\\n        script.src = \\\"\" + Meteor.settings.public.CDN_HOST + \"/\" + type + \"Widget.bundle.js\\\";\\n        script.async = true;\\n\\n        var entry = document.getElementsByTagName('script')[0];\\n        entry.parentNode.insertBefore(script, entry);\\n      })();\\n    \";\n    }\n\n    return installCodeIncludeScript;\n  }();\n\n  function Common(props, context) {\n    (0, _classCallCheck3.default)(this, Common);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, _Component.call(this, props, context));\n\n    var code = ''; // showed install code automatically in edit mode\n\n    if (props.integration) {\n      var brand = props.integration.brand;\n      code = _this.constructor.getInstallCode(brand.code);\n    }\n\n    _this.state = {\n      code: code,\n      copied: false\n    };\n    _this.handleSubmit = _this.handleSubmit.bind(_this);\n    _this.handleBrandChange = _this.handleBrandChange.bind(_this);\n    return _this;\n  }\n\n  Common.prototype.updateInstallCodeValue = function () {\n    function updateInstallCodeValue(brandId) {\n      if (brandId) {\n        var brand = this.props.brands.find(function (brand) {\n          return brand._id === brandId;\n        });\n        var code = this.constructor.getInstallCode(brand.code);\n        this.setState({\n          code: code,\n          copied: false\n        });\n      }\n    }\n\n    return updateInstallCodeValue;\n  }();\n\n  Common.prototype.handleBrandChange = function () {\n    function handleBrandChange(e) {\n      this.updateInstallCodeValue(e.target.value);\n    }\n\n    return handleBrandChange;\n  }();\n\n  Common.prototype.handleSubmit = function () {\n    function handleSubmit(e) {\n      e.preventDefault();\n      this.context.closeModal();\n      this.props.save({\n        name: document.getElementById('integration-name').value,\n        brandId: document.getElementById('selectBrand').value\n      });\n    }\n\n    return handleSubmit;\n  }();\n\n  Common.prototype.render = function () {\n    function render() {\n      var _this2 = this;\n\n      var integration = this.props.integration || {};\n      return React.createElement(\n        \"form\",\n        {\n          className: \"margined\",\n          onSubmit: this.handleSubmit\n        },\n        React.createElement(\n          FormGroup,\n          {\n            controlId: \"integration-name\"\n          },\n          React.createElement(\n            ControlLabel,\n            null,\n            \"Name\"\n          ),\n          React.createElement(FormControl, {\n            type: \"text\",\n            defaultValue: integration.name,\n            required: true\n          })\n        ),\n        React.createElement(SelectBrand, {\n          brands: this.props.brands,\n          defaultValue: integration.brandId,\n          onChange: this.handleBrandChange\n        }),\n        this.extraContent && this.extraContent(),\n        React.createElement(\n          FormGroup,\n          {\n            controlId: \"install-code\"\n          },\n          React.createElement(\n            ControlLabel,\n            null,\n            \"Install code\"\n          ),\n          React.createElement(\n            \"div\",\n            {\n              className: \"markdown-wrapper\"\n            },\n            React.createElement(ReactMarkdown, {\n              source: this.state.code\n            }),\n            this.state.code ? React.createElement(\n              CopyToClipboard,\n              {\n                text: this.state.code,\n                onCopy: function () {\n                  return _this2.setState({\n                    copied: true\n                  });\n                }\n              },\n              React.createElement(\n                Button,\n                {\n                  bsSize: \"small\",\n                  bsStyle: \"primary\"\n                },\n                this.state.copied ? 'Copied' : 'Copy to clipboard'\n              )\n            ) : null\n          )\n        ),\n        React.createElement(\n          Modal.Footer,\n          null,\n          React.createElement(\n            ButtonToolbar,\n            {\n              className: \"pull-right\"\n            },\n            React.createElement(\n              Button,\n              {\n                type: \"submit\",\n                bsStyle: \"primary\"\n              },\n              \"Save\"\n            )\n          )\n        )\n      );\n    }\n\n    return render;\n  }();\n\n  return Common;\n}(Component);\n\nCommon.propTypes = {\n  brands: PropTypes.array.isRequired,\n  // eslint-disable-line\n  integration: PropTypes.object,\n  // eslint-disable-line\n  save: PropTypes.func.isRequired\n};\nCommon.contextTypes = {\n  closeModal: PropTypes.func.isRequired\n};\nmodule.export(\"default\", exports.default = Common);","map":{"version":3,"sources":["/imports/react-ui/settings/integrations/components/Common.js"],"names":["Meteor","module","importSync","v","React","Component","PropTypes","FormGroup","ControlLabel","FormControl","Button","ButtonToolbar","Modal","ReactMarkdown","CopyToClipboard","SelectBrand","Common","installCodeIncludeScript","type","settings","public","CDN_HOST","props","context","code","integration","brand","constructor","getInstallCode","state","copied","handleSubmit","bind","handleBrandChange","updateInstallCodeValue","brandId","brands","find","_id","setState","e","target","value","preventDefault","closeModal","save","name","document","getElementById","render","extraContent","propTypes","array","isRequired","object","func","contextTypes","export","exports","default"],"mappings":"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","file":"/imports/react-ui/settings/integrations/components/Common.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  FormGroup,\n  ControlLabel,\n  FormControl,\n  Button,\n  ButtonToolbar,\n  Modal,\n} from 'react-bootstrap';\nimport ReactMarkdown from 'react-markdown';\nimport CopyToClipboard from 'react-copy-to-clipboard';\nimport SelectBrand from './SelectBrand';\n\nclass Common extends Component {\n  static installCodeIncludeScript(type) {\n    return `\n      (function() {\n        var script = document.createElement('script');\n        script.src = \"${Meteor.settings.public.CDN_HOST}/${type}Widget.bundle.js\";\n        script.async = true;\n\n        var entry = document.getElementsByTagName('script')[0];\n        entry.parentNode.insertBefore(script, entry);\n      })();\n    `;\n  }\n\n  constructor(props, context) {\n    super(props, context);\n\n    let code = '';\n\n    // showed install code automatically in edit mode\n    if (props.integration) {\n      const brand = props.integration.brand;\n      code = this.constructor.getInstallCode(brand.code);\n    }\n\n    this.state = {\n      code,\n      copied: false,\n    };\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleBrandChange = this.handleBrandChange.bind(this);\n  }\n\n  updateInstallCodeValue(brandId) {\n    if (brandId) {\n      const brand = this.props.brands.find(brand => brand._id === brandId);\n\n      const code = this.constructor.getInstallCode(brand.code);\n\n      this.setState({ code, copied: false });\n    }\n  }\n\n  handleBrandChange(e) {\n    this.updateInstallCodeValue(e.target.value);\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n\n    this.context.closeModal();\n\n    this.props.save({\n      name: document.getElementById('integration-name').value,\n      brandId: document.getElementById('selectBrand').value,\n    });\n  }\n\n  render() {\n    const integration = this.props.integration || {};\n\n    return (\n      <form className=\"margined\" onSubmit={this.handleSubmit}>\n        <FormGroup controlId=\"integration-name\">\n          <ControlLabel>Name</ControlLabel>\n          <FormControl type=\"text\" defaultValue={integration.name} required />\n        </FormGroup>\n\n        <SelectBrand\n          brands={this.props.brands}\n          defaultValue={integration.brandId}\n          onChange={this.handleBrandChange}\n        />\n\n        {this.extraContent && this.extraContent()}\n\n        <FormGroup controlId=\"install-code\">\n          <ControlLabel>Install code</ControlLabel>\n          <div className=\"markdown-wrapper\">\n            <ReactMarkdown source={this.state.code} />\n            {this.state.code\n              ? <CopyToClipboard\n                  text={this.state.code}\n                  onCopy={() => this.setState({ copied: true })}\n                >\n                  <Button bsSize=\"small\" bsStyle=\"primary\">\n                    {this.state.copied ? 'Copied' : 'Copy to clipboard'}\n                  </Button>\n                </CopyToClipboard>\n              : null}\n          </div>\n        </FormGroup>\n\n        <Modal.Footer>\n          <ButtonToolbar className=\"pull-right\">\n            <Button type=\"submit\" bsStyle=\"primary\">\n              Save\n            </Button>\n          </ButtonToolbar>\n        </Modal.Footer>\n      </form>\n    );\n  }\n}\n\nCommon.propTypes = {\n  brands: PropTypes.array.isRequired, // eslint-disable-line\n  integration: PropTypes.object, // eslint-disable-line\n  save: PropTypes.func.isRequired,\n};\n\nCommon.contextTypes = {\n  closeModal: PropTypes.func.isRequired,\n};\n\nexport default Common;\n"]},"hash":"77afe06dff5b846f94d9c1ab5abb39993edd610c"}
